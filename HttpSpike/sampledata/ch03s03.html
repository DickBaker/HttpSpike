<!--[if IE]><![endif]--><!DOCTYPE html>
<!--[if IE 8]><html class="no-js ie8 oldie" lang="en" prefix="og: http://ogp.me/ns/# og:book: http://ogp.me/ns/book# og:video: http://ogp.me/ns/video#"            itemscope itemtype="http://schema.org/Book http://schema.org/ItemPage" data-login-url="/accounts/login/"data-offline-url="/"data-url="/library/view/mastering-akka/9781786465023/ch03s03.html"data-csrf-cookie="csrfsafari"data-highlight-privacy=""  data-user-id="3601225"  data-user-uuid="a575397d-f5bb-41a4-b0d4-f45817ae0306"  data-username="ottoventeduo"  data-account-type="Trial"    data-activated-trial-date="10/22/2018"  data-archive="9781786465023"  data-publishers="Packt Publishing"  data-htmlfile-name="ch03s03.html"  data-epub-title="Mastering Akka" data-debug=0 data-testing=0><![endif]--><!--[if gt IE 8]><!-->
<html class=" js flexbox flexboxlegacy no-touch websqldatabase indexeddb history csscolumns csstransforms localstorage sessionstorage applicationcache svg inlinesvg zoom" lang="en" prefix="og: http://ogp.me/ns/# og:book: http://ogp.me/ns/book# og:video: http://ogp.me/ns/video#" itemscope="" itemtype="http://schema.org/Book http://schema.org/ItemPage" data-login-url="/accounts/login/" data-offline-url="/" data-url="/library/view/mastering-akka/9781786465023/ch03s03.html" data-csrf-cookie="csrfsafari" data-highlight-privacy="" data-user-id="3601225" data-user-uuid="a575397d-f5bb-41a4-b0d4-f45817ae0306" data-username="ottoventeduo" data-account-type="Trial" data-activated-trial-date="10/22/2018" data-archive="9781786465023" data-publishers="Packt Publishing" data-htmlfile-name="ch03s03.html" data-epub-title="Mastering Akka" data-debug="0" data-testing="0" style="">
<!--<![endif]-->
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="author" content="Safari Books Online">
  <meta name="format-detection" content="telephone=no">
  <meta http-equiv="cleartype" content="on">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="apple-itunes-app" content="app-id=881697395, app-argument=safaridetail://9781786465023">
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, maximum-scale=1.0">
  <meta property="twitter:account_id" content="4503599627559754">
  <link rel="apple-touch-icon" href="https://www.safaribooksonline.com/static/images/apple-touch-icon.0c29511d2d72.png">
  <link rel="shortcut icon" href="https://www.safaribooksonline.com/favicon.ico" type="image/x-icon">
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400,600,700,900,200italic,300italic,400italic,600italic,700italic,900italic" rel="stylesheet" type="text/css">
  <title>Designing our DDD refactor - Mastering Akka</title>
  <link rel="stylesheet" href="https://www.safaribooksonline.com/static/CACHE/css/5e586a47a3b7.css" type="text/css">
  <link rel="stylesheet" type="text/css" href="https://www.safaribooksonline.com/static/css/annotator.e3b0c44298fc.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
  <style type="text/css" title="ibis-book">
    #sbo-rt-content div, #sbo-rt-content td, #sbo-rt-content th, #sbo-rt-content div {
      font-family: sans-serif
    }

    #sbo-rt-content div {
      font-weight: 400
    }

    #sbo-rt-content th {
      font-weight: 700
    }

    #sbo-rt-content p.paragraph_style {
      margin-bottom: .66em;
      line-height: 15px;
      font-weight: 400;
      text-indent: 0
    }

    #sbo-rt-content h2.paragraph_style {
      margin-bottom: .66em;
      z-index: 10000;
      line-height: 15px
    }

    #sbo-rt-content h3.paragraph_style {
      margin-bottom: .66em;
      z-index: 10000;
      line-height: 15px
    }

    #sbo-rt-content a.paragraph_style {
      font-weight: 400;
      text-indent: 0
    }

    #sbo-rt-content #book-contents p {
      z-index: 100
    }

    #sbo-rt-content p {
      padding-top: 0;
      margin-bottom: 1em;
      z-index: 100;
      text-indent: 0
    }

    #sbo-rt-content img {
      max-width: 100%;
      height: auto
    }

    #sbo-rt-content h1, #sbo-rt-content h2, #sbo-rt-content h3, #sbo-rt-content h4, #sbo-rt-content h5, #sbo-rt-content h6 {
      margin-top: 0;
      margin-bottom: .66em;
      font-weight: 700;
      clear: both
    }

    #sbo-rt-content p {
      clear: both
    }

    #sbo-rt-content h1 {
      font-size: 2em
    }

    #sbo-rt-content h2 {
      color: #ff9b2f;
      font-size: 1.6em
    }

    #sbo-rt-content h3 {
      margin: 14px 0 6px;
      font-size: 1.3em;
      color: green
    }

    #sbo-rt-content h4 {
      color: #BD1D1D
    }

    #sbo-rt-content div.informalfigure {
      margin: 1px auto 10px
    }

      #sbo-rt-content div.informalfigure table {
        margin-left: auto;
        margin-right: auto
      }

    #sbo-rt-content span.bold, #sbo-rt-content strong {
      font-weight: 700
    }

    #sbo-rt-content div.informaltable {
      border-top: 0;
      border-bottom: 0;
      margin-top: 5px;
      margin-bottom: 5px;
      border-left: 0;
      border-right: 0;
      border-style: solid;
      border-color: #000
    }

      #sbo-rt-content div.informaltable table {
        width: 100%;
        margin: 2em 0
      }

    #sbo-rt-content div.toc {
      display: none
    }

    #sbo-rt-content div.informaltable table {
      border-width: 0 1px;
      border-spacing: 0;
      border-style: solid;
      border-color: #000;
      border-collapse: collapse;
      background-color: #fff
    }

      #sbo-rt-content div.informaltable table th {
        border-width: 1px;
        padding: 3px;
        border-style: solid;
        border-color: #000;
        background-color: #fff
      }

      #sbo-rt-content div.informaltable table td {
        border-width: 1px;
        padding: 3px;
        border-style: solid;
        border-color: #000;
        background-color: #fff
      }

    #sbo-rt-content .book_title a {
      color: #000
    }

    #sbo-rt-content .author_name {
      font-style: italic
    }

    #sbo-rt-content .mediaobject table {
      margin: .5em 0 1em
    }

    #sbo-rt-content pre, #sbo-rt-content pre.programlisting {
      color: blue;
      clear: both;
      margin: .5em 2em;
      overflow: auto;
      padding: .5em 2em;
      white-space: pre-wrap;
      word-wrap: break-word
    }

    #sbo-rt-content div.informalexample {
      word-wrap: break-word
    }

    #sbo-rt-content pre.programlisting span.bold {
      font-weight: 700
    }

    #sbo-rt-content code.literal {
      color: blue
    }

    #sbo-rt-content div.mediaobject img {
      margin-left: auto;
      margin-right: auto
    }

    #sbo-rt-content div.mediaobject {
      margin-bottom: 1em;
      margin-left: auto;
      margin-right: auto;
      text-align: center
    }

    #sbo-rt-content div.note p {
      clear: none
    }

    #sbo-rt-content div.section .title {
      color: #ff9b2f;
      font-weight: 700
    }

    #sbo-rt-content div.section div.section .title {
      color: green;
      font-weight: 700
    }

    #sbo-rt-content div.section div.section div.section .title {
      color: #BD1D1D;
      font-weight: 700
    }

    #sbo-rt-content div.section div.section div.section div.section .title {
      font-weight: 700
    }

    #sbo-rt-content div.section div.section div.section div.section div.section .title {
      font-weight: 700
    }

    #sbo-rt-content div.section div.section div.section div.section div.section div.section .title {
      font-weight: 700
    }

    #sbo-rt-content body#page div.note h3 {
      color: #000
    }

    #sbo-rt-content div.caption {
      font-size: smaller;
      font-style: italic;
      text-align: center;
      margin-top: .5em;
      margin-bottom: 1em
    }

    #sbo-rt-content div.preface p span.bold {
      display: block
    }

    #sbo-rt-content div.preface pre span.bold {
      display: inline
    }

    #sbo-rt-content div.preface div.section p span.bold {
      display: inline
    }

    #sbo-rt-content div.section pre.programlisting span.bold {
      float: left;
      clear: left
    }

    #sbo-rt-content div.preface div.titlepage h2.title {
      text-align: left
    }

    #sbo-rt-content div.note, #sbo-rt-content div.tip, #sbo-rt-content div.sidebar {
      word-wrap: break-word;
      margin: 0 0 1em;
      padding: 0;
      border: 1px solid #777;
      background-color: #e0e0e0;
      clear: both
    }

      #sbo-rt-content div.note div.mediaobject {
        margin-bottom: 1em
      }

    #sbo-rt-content ul, #sbo-rt-content ol {
      margin-bottom: 1em
    }

    #sbo-rt-content li ul, #sbo-rt-content li ol {
      margin-top: 1em
    }

    #sbo-rt-content div.blockquote blockquote {
      text-align: center;
      font-style: italic;
      margin: 2em 0
    }

    #sbo-rt-content div.mediaobject table {
      margin-left: auto;
      margin-right: auto
    }

    #sbo-rt-content pre.programlisting span.bold {
      float: none
    }

    #sbo-rt-content div.note div.inner, #sbo-rt-content div.tip div.inner, #sbo-rt-content div.sidebar div.inner {
      margin: .75em
    }

    #sbo-rt-content div.tip {
      border-style: dashed
    }

      #sbo-rt-content div.note h3.title, #sbo-rt-content div.tip h3.title {
        color: #000
      }

    #sbo-rt-content em {
      font-style: italic
    }

    #sbo-rt-content div.x-form-element {
      padding-bottom: 2px
    }

    #sbo-rt-content .w175 {
      width: 175px
    }

    #sbo-rt-content img.nframe {
      margin-left: 0;
      width: 600px
    }

    #sbo-rt-content div.note h2, #sbo-rt-content div.note h3, #sbo-rt-content div.tip h2, #sbo-rt-content div.tip h3 {
      color: #000 !important
    }

    #sbo-rt-content div.note p, #sbo-rt-content div.tip p, #sbo-rt-content div.sidebar p, #sbo-rt-content div.note ol, #sbo-rt-content div.note ul {
      width: 100%;
      margin-left: 0 !important
    }

    #sbo-rt-content ol.arabic, #sbo-rt-content ol.arabic li {
      list-style-type: decimal
    }

    #sbo-rt-content ol.lowerroman, #sbo-rt-content ol.lowerroman li {
      list-style-type: lower-roman
    }

    #sbo-rt-content ol.loweralpha, #sbo-rt-content ol.loweralpha li {
      list-style-type: lower-alpha
    }

    #sbo-rt-content li div.mediaobject, #sbo-rt-content li div.note, #sbo-rt-content li div.tip, #sbo-rt-content li div.sidebar, #sbo-rt-content li table, #sbo-rt-content li h1, #sbo-rt-content li h2, #sbo-rt-content li h3, #sbo-rt-content li h4, #sbo-rt-content li h5, #sbo-rt-content li h6 {
      margin-top: 1em
    }

    #sbo-rt-content div.note div.mediaobject {
      margin-top: 1em
    }
  </style>
  <link rel="canonical" href="https://www.safaribooksonline.com/library/view/mastering-akka/9781786465023/ch03s03.html">
  <meta name="description" content="Designing our DDD refactor Before we get started with laying out the DDD refactor, it bears mentioning that as the code stands right now, DDD is probably a bit much ... ">
  <meta property="og:title" content="Designing our DDD refactor">
  <meta itemprop="isPartOf" content="/library/view/mastering-akka/9781786465023/">
  <meta itemprop="name" content="Designing our DDD refactor">
  <meta property="og:url" itemprop="url" content="https://www.safaribooksonline.com/library/view/mastering-akka/9781786465023/ch03s03.html">
  <meta property="og:site_name" content="Safari">
  <meta property="og:image" itemprop="thumbnailUrl" content="https://www.safaribooksonline.com/library/cover/9781786465023/">
  <meta property="og:description" itemprop="description" content="Designing our DDD refactor Before we get started with laying out the DDD refactor, it bears mentioning that as the code stands right now, DDD is probably a bit much ... ">
  <meta itemprop="inLanguage" content="en">
  <meta itemprop="publisher" content="Packt Publishing">
  <meta property="og:type" content="book">
  <meta property="og:book:isbn" itemprop="isbn" content="9781786465023">
  <meta property="og:book:author" itemprop="author" content="Christian Baxter">
  <meta property="og:book:tag" itemprop="about" content="Design">
  <meta property="og:book:tag" itemprop="about" content="Web Development">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@safari">
  <style type="text/css" id="font-styles" data-template="#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-size: <%= font_size %> !important; }"></style>
  <style type="text/css" id="font-family" data-template="#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-family: <%= font_family %> !important; }"></style>
  <style type="text/css" id="column-width" data-template="#sbo-rt-content { max-width: <%= column_width %>% !important; margin: 0 auto !important; }"></style>
  <style id="annotator-dynamic-style">
    .annotator-adder, .annotator-outer, .annotator-notice {
      z-index: 100019;
    }

    .annotator-filter {
      z-index: 100009;
    }
  </style>
</head>
<body class="reading sidenav nav-collapsed  scalefonts subscribe-panel library">
  <div class="hide working" role="status">        <div class="working-image"></div>      </div>      <div class="sbo-site-nav">        <a href="https://www.safaribooksonline.com/library/view/mastering-akka/9781786465023/ch03s03.html#container" class="skip">Skip to content</a><header class="topbar t-topbar"><nav role="navigation" class="js-site-nav"><ul class="topnav"><li class="t-logo"><a href="https://www.safaribooksonline.com/home/" class="l0 None safari-home nav-icn js-keyboard-nav-home"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20" version="1.1" fill="#4A3C31"><desc>Safari Home Icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M4 9.9L4 9.9 4 18 16 18 16 9.9 10 4 4 9.9ZM2.6 8.1L2.6 8.1 8.7 1.9 10 0.5 11.3 1.9 17.4 8.1 18 8.7 18 9.5 18 18.1 18 20 16.1 20 3.9 20 2 20 2 18.1 2 9.5 2 8.7 2.6 8.1Z"></path><rect x="10" y="12" width="3" height="7"></rect><rect transform="translate(18.121320, 10.121320) rotate(-315.000000) translate(-18.121320, -10.121320) " x="16.1" y="9.1" width="4" height="2"></rect><rect transform="translate(2.121320, 10.121320) scale(-1, 1) rotate(-315.000000) translate(-2.121320, -10.121320) " x="0.1" y="9.1" width="4" height="2"></rect></g></svg><span>Safari Home</span></a></li><li><a href="https://www.safaribooksonline.com/r/" class="t-recommendations-nav l0 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="20" height="20" version="1.1" fill="#4A3C31"><desc>recommendations icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M50 25C50 18.2 44.9 12.5 38.3 11.7 37.5 5.1 31.8 0 25 0 18.2 0 12.5 5.1 11.7 11.7 5.1 12.5 0 18.2 0 25 0 31.8 5.1 37.5 11.7 38.3 12.5 44.9 18.2 50 25 50 31.8 50 37.5 44.9 38.3 38.3 44.9 37.5 50 31.8 50 25ZM25 3.1C29.7 3.1 33.6 6.9 34.4 11.8 30.4 12.4 26.9 15.1 25 18.8 23.1 15.1 19.6 12.4 15.6 11.8 16.4 6.9 20.3 3.1 25 3.1ZM34.4 15.6C33.6 19.3 30.7 22.2 27.1 22.9 27.8 19.2 30.7 16.3 34.4 15.6ZM22.9 22.9C19.2 22.2 16.3 19.3 15.6 15.6 19.3 16.3 22.2 19.2 22.9 22.9ZM3.1 25C3.1 20.3 6.9 16.4 11.8 15.6 12.4 19.6 15.1 23.1 18.8 25 15.1 26.9 12.4 30.4 11.8 34.4 6.9 33.6 3.1 29.7 3.1 25ZM22.9 27.1C22.2 30.7 19.3 33.6 15.6 34.4 16.3 30.7 19.2 27.8 22.9 27.1ZM25 46.9C20.3 46.9 16.4 43.1 15.6 38.2 19.6 37.6 23.1 34.9 25 31.3 26.9 34.9 30.4 37.6 34.4 38.2 33.6 43.1 29.7 46.9 25 46.9ZM27.1 27.1C30.7 27.8 33.6 30.7 34.4 34.4 30.7 33.6 27.8 30.7 27.1 27.1ZM38.2 34.4C37.6 30.4 34.9 26.9 31.3 25 34.9 23.1 37.6 19.6 38.2 15.6 43.1 16.4 46.9 20.3 46.9 25 46.9 29.7 43.1 33.6 38.2 34.4Z"></path></g></svg><span>Recommended</span></a></li><li><a href="https://www.safaribooksonline.com/playlists/" class="t-queue-nav l0 nav-icn None"><!--?xml version="1.0" encoding="UTF-8"?--><svg width="21px" height="17px" viewBox="0 0 21 17" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><!-- Generator: Sketch 46.2 (44496) - http://www.bohemiancoding.com/sketch --><title>icon_Playlist_sml</title><desc>Created with Sketch.</desc><defs></defs><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="icon_Playlist_sml" fill-rule="nonzero" fill="#000000"><g id="playlist-icon"><g id="Group-6"><rect id="Rectangle-path" x="5" y="0" width="16" height="3" rx="0.5"></rect><circle id="Oval" cx="1.5" cy="1.5" r="1.5"></circle></g><g id="Group-5" transform="translate(0.000000, 7.000000)"><circle id="Oval" cx="1.5" cy="1.5" r="1.5"></circle><rect id="Rectangle-path" x="5" y="0" width="16" height="3" rx="0.5"></rect></g><g id="Group-5-Copy" transform="translate(0.000000, 14.000000)"><circle id="Oval" cx="1.5" cy="1.5" r="1.5"></circle><rect id="Rectangle-path" x="5" y="0" width="16" height="3" rx="0.5"></rect></g></g></g></g></svg><span>               Playlists            </span></a></li><li class="search"><a href="https://www.safaribooksonline.com/library/view/mastering-akka/9781786465023/ch03s03.html#" class="t-search-nav trigger nav-icn l0" data-dropdown-selector=".searchbox"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="20" height="20" version="1.1" fill="#4A3C31"><desc>search icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M31.3 0C20.9 0 12.5 8.4 12.5 18.8 12.5 22.5 13.6 25.9 15.4 28.8L1.2 42.9C-0.4 44.5-0.4 47.2 1.2 48.8 2 49.6 3.1 50 4.2 50 5.2 50 6.3 49.6 7.1 48.8L21.2 34.6C24.1 36.5 27.5 37.5 31.3 37.5 41.6 37.5 50 29.1 50 18.8 50 8.4 41.6 0 31.3 0ZM31.3 31.3C24.4 31.3 18.8 25.6 18.8 18.8 18.8 11.9 24.4 6.3 31.3 6.3 38.1 6.3 43.8 11.9 43.8 18.8 43.8 25.6 38.1 31.3 31.3 31.3Z"></path></g></svg><span>Search</span></a></li><li class="usermenu dropdown"><a href="https://www.safaribooksonline.com/library/view/mastering-akka/9781786465023/ch03s03.html#" class="trigger l0 nav-icn nav-dropdown"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20" version="1.1" fill="#4A3C31"><desc>navigation arrow</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M0.1 12.5L9.7 3.1C9.8 3 9.9 3 10 3 10.1 3 10.2 3 10.3 3.1L19.9 12.5C20 12.5 20 12.6 20 12.8 20 12.9 20 13 19.9 13L17 15.9C16.9 16 16.8 16 16.7 16 16.5 16 16.4 16 16.4 15.9L10 9.7 3.6 15.9C3.6 16 3.5 16 3.3 16 3.2 16 3.1 16 3 15.9L0.1 13C0 12.9 0 12.8 0 12.7 0 12.7 0 12.6 0.1 12.5Z"></path></g></svg><span>Expand Nav</span></a><div class="drop-content"><ul><li><a href="https://www.safaribooksonline.com/history/" class="t-recent-nav l1 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="20" height="20" version="1.1" fill="#4A3C31"><desc>recent items icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M25 0C11.2 0 0 11.2 0 25 0 38.8 11.2 50 25 50 38.8 50 50 38.8 50 25 50 11.2 38.8 0 25 0ZM6.3 25C6.3 14.6 14.6 6.3 25 6.3 35.4 6.3 43.8 14.6 43.8 25 43.8 35.4 35.4 43.8 25 43.8 14.6 43.8 6.3 35.4 6.3 25ZM31.8 31.5C32.5 30.5 32.4 29.2 31.6 28.3L27.1 23.8 27.1 12.8C27.1 11.5 26.2 10.4 25 10.4 23.9 10.4 22.9 11.5 22.9 12.8L22.9 25.7 28.8 31.7C29.2 32.1 29.7 32.3 30.2 32.3 30.8 32.3 31.3 32 31.8 31.5Z"></path></g></svg><span>History</span></a></li><li><a href="https://www.safaribooksonline.com/topics" class="t-topics-link l1 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 55" width="20" height="20" version="1.1" fill="#4A3C31"><desc>topics icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M25 55L50 41.262 50 13.762 25 0 0 13.762 0 41.262 25 55ZM8.333 37.032L8.333 17.968 25 8.462 41.667 17.968 41.667 37.032 25 46.538 8.333 37.032Z"></path></g></svg><span>Topics</span></a></li><li><a href="https://www.safaribooksonline.com/tutorials/" class="l1 nav-icn t-tutorials-nav js-toggle-menu-item None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20" version="1.1" fill="#4A3C31"><desc>tutorials icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M15.8 18.2C15.8 18.2 15.9 18.2 16 18.2 16.1 18.2 16.2 18.2 16.4 18.2 16.5 18.2 16.7 18.1 16.9 18 17 17.9 17.1 17.8 17.2 17.7 17.3 17.6 17.4 17.5 17.4 17.4 17.5 17.2 17.6 16.9 17.6 16.7 17.6 16.6 17.6 16.5 17.6 16.4 17.5 16.2 17.5 16.1 17.4 15.9 17.3 15.8 17.2 15.6 17 15.5 16.8 15.3 16.6 15.3 16.4 15.2 16.2 15.2 16 15.2 15.8 15.2 15.7 15.2 15.5 15.3 15.3 15.4 15.2 15.4 15.1 15.5 15 15.7 14.9 15.8 14.8 15.9 14.7 16 14.7 16.1 14.6 16.3 14.6 16.4 14.6 16.5 14.6 16.6 14.6 16.6 14.6 16.7 14.6 16.9 14.6 17 14.6 17.1 14.7 17.3 14.7 17.4 14.8 17.6 15 17.7 15.1 17.9 15.2 18 15.3 18 15.5 18.1 15.5 18.1 15.6 18.2 15.7 18.2 15.7 18.2 15.7 18.2 15.8 18.2L15.8 18.2ZM9.4 11.5C9.5 11.5 9.5 11.5 9.6 11.5 9.7 11.5 9.9 11.5 10 11.5 10.2 11.5 10.3 11.4 10.5 11.3 10.6 11.2 10.8 11.1 10.9 11 10.9 10.9 11 10.8 11.1 10.7 11.2 10.5 11.2 10.2 11.2 10 11.2 9.9 11.2 9.8 11.2 9.7 11.2 9.5 11.1 9.4 11 9.2 10.9 9.1 10.8 8.9 10.6 8.8 10.5 8.7 10.3 8.6 10 8.5 9.9 8.5 9.7 8.5 9.5 8.5 9.3 8.5 9.1 8.6 9 8.7 8.8 8.7 8.7 8.8 8.6 9 8.5 9.1 8.4 9.2 8.4 9.3 8.2 9.5 8.2 9.8 8.2 10 8.2 10.1 8.2 10.2 8.2 10.3 8.2 10.5 8.3 10.6 8.4 10.7 8.5 10.9 8.6 11.1 8.7 11.2 8.9 11.3 9 11.4 9.1 11.4 9.2 11.4 9.3 11.5 9.3 11.5 9.3 11.5 9.4 11.5 9.4 11.5L9.4 11.5ZM3 4.8C3.1 4.8 3.1 4.8 3.2 4.8 3.4 4.8 3.5 4.8 3.7 4.8 3.8 4.8 4 4.7 4.1 4.6 4.3 4.5 4.4 4.4 4.5 4.3 4.6 4.2 4.6 4.1 4.7 4 4.8 3.8 4.8 3.5 4.8 3.3 4.8 3.1 4.8 3 4.8 2.9 4.7 2.8 4.7 2.6 4.6 2.5 4.5 2.3 4.4 2.2 4.2 2.1 4 1.9 3.8 1.9 3.6 1.8 3.5 1.8 3.3 1.8 3.1 1.8 2.9 1.8 2.7 1.9 2.6 2 2.4 2.1 2.3 2.2 2.2 2.3 2.1 2.4 2 2.5 2 2.6 1.8 2.8 1.8 3 1.8 3.3 1.8 3.4 1.8 3.5 1.8 3.6 1.8 3.8 1.9 3.9 2 4 2.1 4.2 2.2 4.4 2.4 4.5 2.5 4.6 2.6 4.7 2.7 4.7 2.8 4.7 2.9 4.8 2.9 4.8 3 4.8 3 4.8 3 4.8L3 4.8ZM13.1 15.2C13.2 15.1 13.2 15.1 13.2 15.1 13.3 14.9 13.4 14.7 13.6 14.5 13.8 14.2 14.1 14 14.4 13.8 14.7 13.6 15.1 13.5 15.5 13.4 15.9 13.4 16.3 13.4 16.7 13.5 17.2 13.5 17.6 13.7 17.9 13.9 18.2 14.1 18.5 14.4 18.7 14.7 18.9 15 19.1 15.3 19.2 15.6 19.3 15.9 19.4 16.1 19.4 16.4 19.4 17 19.3 17.5 19.1 18.1 19 18.3 18.9 18.5 18.7 18.7 18.5 19 18.3 19.2 18 19.4 17.7 19.6 17.3 19.8 16.9 19.9 16.6 20 16.3 20 16 20 15.8 20 15.6 20 15.4 19.9 15.4 19.9 15.4 19.9 15.4 19.9 15.2 19.9 15 19.8 14.9 19.8 14.8 19.7 14.7 19.7 14.6 19.7 14.4 19.6 14.3 19.5 14.1 19.3 13.7 19.1 13.4 18.7 13.2 18.4 13.1 18.1 12.9 17.8 12.9 17.5 12.8 17.3 12.8 17.1 12.8 16.9L3.5 14.9C3.3 14.9 3.1 14.8 3 14.8 2.7 14.7 2.4 14.5 2.1 14.3 1.7 14 1.4 13.7 1.2 13.3 1 13 0.9 12.6 0.8 12.3 0.7 12 0.7 11.7 0.7 11.4 0.7 11 0.8 10.5 1 10.1 1.1 9.8 1.3 9.5 1.6 9.2 1.8 8.9 2.1 8.7 2.4 8.5 2.8 8.3 3.2 8.1 3.6 8.1 3.9 8 4.2 8 4.5 8 4.6 8 4.8 8 4.9 8.1L6.8 8.5C6.8 8.4 6.8 8.4 6.8 8.4 6.9 8.2 7.1 8 7.2 7.8 7.5 7.5 7.7 7.3 8 7.1 8.4 6.9 8.7 6.8 9.1 6.7 9.5 6.7 10 6.7 10.4 6.8 10.8 6.8 11.2 7 11.5 7.2 11.8 7.5 12.1 7.7 12.4 8 12.6 8.3 12.7 8.6 12.8 8.9 12.9 9.2 13 9.4 13 9.7 13 9.7 13 9.8 13 9.8 13.6 9.9 14.2 10.1 14.9 10.2 15 10.2 15 10.2 15.1 10.2 15.3 10.2 15.4 10.2 15.6 10.2 15.8 10.1 16 10 16.2 9.9 16.4 9.8 16.5 9.6 16.6 9.5 16.8 9.2 16.9 8.8 16.9 8.5 16.9 8.3 16.9 8.2 16.8 8 16.8 7.8 16.7 7.7 16.6 7.5 16.5 7.3 16.3 7.2 16.2 7.1 16 7 15.9 6.9 15.8 6.9 15.7 6.9 15.6 6.8 15.5 6.8L6.2 4.8C6.2 5 6 5.2 5.9 5.3 5.7 5.6 5.5 5.8 5.3 6 4.9 6.2 4.5 6.4 4.1 6.5 3.8 6.6 3.5 6.6 3.2 6.6 3 6.6 2.8 6.6 2.7 6.6 2.6 6.6 2.6 6.5 2.6 6.5 2.5 6.5 2.3 6.5 2.1 6.4 1.8 6.3 1.6 6.1 1.3 6 1 5.7 0.7 5.4 0.5 5 0.3 4.7 0.2 4.4 0.1 4.1 0 3.8 0 3.6 0 3.3 0 2.8 0.1 2.2 0.4 1.7 0.5 1.5 0.7 1.3 0.8 1.1 1.1 0.8 1.3 0.6 1.6 0.5 2 0.3 2.3 0.1 2.7 0.1 3.1 0 3.6 0 4 0.1 4.4 0.2 4.8 0.3 5.1 0.5 5.5 0.8 5.7 1 6 1.3 6.2 1.6 6.3 1.9 6.4 2.3 6.5 2.5 6.6 2.7 6.6 3 6.6 3 6.6 3.1 6.6 3.1 9.7 3.8 12.8 4.4 15.9 5.1 16.1 5.1 16.2 5.2 16.4 5.2 16.7 5.3 16.9 5.5 17.2 5.6 17.5 5.9 17.8 6.2 18.1 6.5 18.3 6.8 18.4 7.2 18.6 7.5 18.6 7.9 18.7 8.2 18.7 8.6 18.7 9 18.6 9.4 18.4 9.8 18.3 10.1 18.2 10.3 18 10.6 17.8 10.9 17.5 11.1 17.3 11.3 16.9 11.6 16.5 11.8 16 11.9 15.7 12 15.3 12 15 12 14.8 12 14.7 12 14.5 11.9 13.9 11.8 13.3 11.7 12.6 11.5 12.5 11.7 12.4 11.9 12.3 12 12.1 12.3 11.9 12.5 11.7 12.7 11.3 12.9 10.9 13.1 10.5 13.2 10.2 13.3 9.9 13.3 9.6 13.3 9.4 13.3 9.2 13.3 9 13.2 9 13.2 9 13.2 9 13.2 8.8 13.2 8.7 13.2 8.5 13.1 8.2 13 8 12.8 7.7 12.6 7.4 12.4 7.1 12 6.8 11.7 6.7 11.4 6.6 11.1 6.5 10.8 6.4 10.6 6.4 10.4 6.4 10.2 5.8 10.1 5.2 9.9 4.5 9.8 4.4 9.8 4.4 9.8 4.3 9.8 4.1 9.8 4 9.8 3.8 9.8 3.6 9.9 3.4 10 3.2 10.1 3 10.2 2.9 10.4 2.8 10.5 2.6 10.8 2.5 11.1 2.5 11.5 2.5 11.6 2.5 11.8 2.6 12 2.6 12.1 2.7 12.3 2.8 12.5 2.9 12.6 3.1 12.8 3.2 12.9 3.3 13 3.5 13.1 3.6 13.1 3.7 13.1 3.8 13.2 3.9 13.2L13.1 15.2 13.1 15.2Z"></path></g></svg><span>Tutorials</span></a></li><li class="nav-offers flyout-parent"><a href="https://www.safaribooksonline.com/library/view/mastering-akka/9781786465023/ch03s03.html#" class="l1 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="20" height="20" version="1.1" fill="#4A3C31"><desc>offers icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M35.9 20.6L27 15.5C26.1 15 24.7 15 23.7 15.5L14.9 20.6C13.9 21.1 13.2 22.4 13.2 23.4L13.2 41.4C13.2 42.4 13.9 43.7 14.9 44.2L23.3 49C24.2 49.5 25.6 49.5 26.6 49L35.9 43.6C36.8 43.1 37.6 41.8 37.6 40.8L37.6 23.4C37.6 22.4 36.8 21.1 35.9 20.6L35.9 20.6ZM40 8.2C39.1 7.6 37.6 7.6 36.7 8.2L30.2 11.9C29.3 12.4 29.3 13.2 30.2 13.8L39.1 18.8C40 19.4 40.7 20.6 40.7 21.7L40.7 39C40.7 40.1 41.4 40.5 42.4 40L48.2 36.6C49.1 36.1 49.8 34.9 49.8 33.8L49.8 15.6C49.8 14.6 49.1 13.3 48.2 12.8L40 8.2 40 8.2ZM27 10.1L33.6 6.4C34.5 5.9 34.5 5 33.6 4.5L26.6 0.5C25.6 0 24.2 0 23.3 0.5L16.7 4.2C15.8 4.7 15.8 5.6 16.7 6.1L23.7 10.1C24.7 10.6 26.1 10.6 27 10.1ZM10.1 21.7C10.1 20.6 10.8 19.4 11.7 18.8L20.6 13.8C21.5 13.2 21.5 12.4 20.6 11.9L13.6 7.9C12.7 7.4 11.2 7.4 10.3 7.9L1.6 12.8C0.7 13.3 0 14.6 0 15.6L0 33.8C0 34.9 0.7 36.1 1.6 36.6L8.4 40.5C9.3 41 10.1 40.6 10.1 39.6L10.1 21.7 10.1 21.7Z"></path></g></svg><span>Offers &amp; Deals</span></a><ul class="flyout"><li><a href="https://get.oreilly.com/email-signup.html" target="_blank" class="l2 nav-icn"><span>Newsletters</span></a></li></ul></li><li class="nav-highlights"><a href="https://www.safaribooksonline.com/u/a575397d-f5bb-41a4-b0d4-f45817ae0306/" class="t-highlights-nav l1 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 35" width="20" height="20" version="1.1" fill="#4A3C31"><desc>highlights icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M13.325 18.071L8.036 18.071C8.036 11.335 12.36 7.146 22.5 5.594L22.5 0C6.37 1.113 0 10.632 0 22.113 0 29.406 3.477 35 10.403 35 15.545 35 19.578 31.485 19.578 26.184 19.578 21.556 17.211 18.891 13.325 18.071L13.325 18.071ZM40.825 18.071L35.565 18.071C35.565 11.335 39.86 7.146 50 5.594L50 0C33.899 1.113 27.5 10.632 27.5 22.113 27.5 29.406 30.977 35 37.932 35 43.045 35 47.078 31.485 47.078 26.184 47.078 21.556 44.74 18.891 40.825 18.071L40.825 18.071Z"></path></g></svg><span>Highlights</span></a></li><li><a href="https://www.safaribooksonline.com/u/preferences/" class="t-settings-nav l1 js-settings nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 53" width="20" height="20" version="1.1" fill="#4A3C31"><desc>settings icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M44.6 29.6C44.7 28.6 44.8 27.5 44.8 26.5 44.8 25.5 44.7 24.4 44.6 23.4L49.6 19C50 18.8 50.1 18.3 49.9 17.9 48.9 14.7 47.1 11.7 44.9 9.1 44.6 8.8 44.2 8.7 43.8 8.8L37.4 11.1C35.8 9.8 34 8.7 32.1 8L30.9 1.4C30.8 0.9 30.4 0.6 30 0.5 26.7-0.2 23.3-0.2 20 0.5 19.6 0.6 19.2 0.9 19.1 1.4L17.9 8C16 8.7 14.1 9.8 12.6 11.1L6.2 8.8C5.8 8.7 5.4 8.8 5.1 9.1 2.9 11.7 1.1 14.7 0.1 17.9 -0.1 18.3 0 18.8 0.4 19L5.4 23.4C5.3 24.4 5.2 25.5 5.2 26.5 5.2 27.5 5.3 28.6 5.4 29.6L0.4 34C0 34.2-0.1 34.7 0.1 35.1 1.1 38.3 2.9 41.4 5.1 43.9 5.4 44.2 5.8 44.4 6.2 44.2L12.6 42C14.1 43.2 16 44.3 17.9 45L19.1 51.7C19.2 52.1 19.6 52.5 20 52.5 21.6 52.8 23.3 53 25 53 26.7 53 28.4 52.8 30 52.5 30.4 52.5 30.8 52.1 30.9 51.7L32.1 45C34 44.3 35.8 43.2 37.4 42L43.8 44.2C44.2 44.4 44.6 44.2 44.9 43.9 47.1 41.4 48.9 38.3 49.9 35.1 50.1 34.7 50 34.2 49.6 34L44.6 29.6ZM25 36.4C19.6 36.4 15.2 32 15.2 26.5 15.2 21 19.6 16.6 25 16.6 30.4 16.6 34.8 21 34.8 26.5 34.8 32 30.4 36.4 25 36.4Z"></path></g></svg><span>Settings</span></a></li><li><a href="https://www.safaribooksonline.com/public/support" class="l1 no-icon">Support</a></li><li><a href="https://www.safaribooksonline.com/accounts/logout/" class="l1 no-icon">Sign Out</a></li></ul><ul class="profile"><li><a href="https://www.safaribooksonline.com/u/preferences/" class="l2 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 53" width="20" height="20" version="1.1" fill="#4A3C31"><desc>settings icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M44.6 29.6C44.7 28.6 44.8 27.5 44.8 26.5 44.8 25.5 44.7 24.4 44.6 23.4L49.6 19C50 18.8 50.1 18.3 49.9 17.9 48.9 14.7 47.1 11.7 44.9 9.1 44.6 8.8 44.2 8.7 43.8 8.8L37.4 11.1C35.8 9.8 34 8.7 32.1 8L30.9 1.4C30.8 0.9 30.4 0.6 30 0.5 26.7-0.2 23.3-0.2 20 0.5 19.6 0.6 19.2 0.9 19.1 1.4L17.9 8C16 8.7 14.1 9.8 12.6 11.1L6.2 8.8C5.8 8.7 5.4 8.8 5.1 9.1 2.9 11.7 1.1 14.7 0.1 17.9 -0.1 18.3 0 18.8 0.4 19L5.4 23.4C5.3 24.4 5.2 25.5 5.2 26.5 5.2 27.5 5.3 28.6 5.4 29.6L0.4 34C0 34.2-0.1 34.7 0.1 35.1 1.1 38.3 2.9 41.4 5.1 43.9 5.4 44.2 5.8 44.4 6.2 44.2L12.6 42C14.1 43.2 16 44.3 17.9 45L19.1 51.7C19.2 52.1 19.6 52.5 20 52.5 21.6 52.8 23.3 53 25 53 26.7 53 28.4 52.8 30 52.5 30.4 52.5 30.8 52.1 30.9 51.7L32.1 45C34 44.3 35.8 43.2 37.4 42L43.8 44.2C44.2 44.4 44.6 44.2 44.9 43.9 47.1 41.4 48.9 38.3 49.9 35.1 50.1 34.7 50 34.2 49.6 34L44.6 29.6ZM25 36.4C19.6 36.4 15.2 32 15.2 26.5 15.2 21 19.6 16.6 25 16.6 30.4 16.6 34.8 21 34.8 26.5 34.8 32 30.4 36.4 25 36.4Z"></path></g></svg><span>Settings</span></a><span class="l2 t-nag-notification" id="nav-nag"><strong class="trial-red">1</strong> days left in your trial.                <a class="" href="https://www.safaribooksonline.com/subscribe/">Subscribe</a>.        </span></li><li><a href="https://www.safaribooksonline.com/public/support" class="l2">Support</a></li><li><a href="https://www.safaribooksonline.com/accounts/logout/" class="l2">Sign Out</a></li></ul></div></li></ul></nav></header>      </div>      <div id="container" class="application" style="height: auto;">                  <div class="nav-container clearfix">                                              </div>            <div class="js-toc">          <div class="sbo-reading-menu sbo-menu-top"><section class="sbo-toc-container toc-menu"><a href="https://www.safaribooksonline.com/library/view/mastering-akka/9781786465023/ch03s03.html#" class="sbo-toc-thumb"><span class="sbo-title ss-list"><h1><div class="visuallyhidden">Table of Contents for </div>            Mastering Akka          </h1></span></a><div class="toc-contents"></div></section></div>        <div class="interface-controls interface-controls-top">      <ul class="interface-control-btns js-bitlist js-reader">        <li class="js-search-in-archive search-in-archive t-search-in-archive"><a href="https://www.safaribooksonline.com/library/view/mastering-akka/9781786465023/ch03s03.html#" title="Search in archive" class="js-search-controls search-controls"><span class="icon">Search in book...</span></a><form class="search-archive-bar js-search-form"><input type="search" name="query" placeholder="Search inside this book..." autocomplete="off"></form><div class="search-archive-results"><div class="js-sitb-results-region"></div></div></li><li class="queue-control"><div class="js-content-uri" data-content-uri="/api/v1/book/9781786465023/chapter/ch03s03.html"><div class="js-collections-dropdown collections-dropdown menu-bit-cards"><div data-reactroot="" class="menu-dropdown-wrapper js-menu-dropdown-wrapper align-right"><img class="hidden" src="https://www.safaribooksonline.com/static/images/ajax-transp.gif" alt="loading spinner"><div class="menu-control"><div class="control "><div class="js-playlists-menu"><button class="js-playlist-icon"><svg class="icon-add-to-playlist-sml" viewBox="0 0 16 14" version="1.1" xmlns="http://www.w3.org/2000/svg"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g fill-rule="nonzero" fill="#000000"><g transform="translate(-1.000000, 0.000000)"><rect x="5" y="0" width="12" height="2"></rect><title>Playlists</title><path d="M4.5,14 C6.43299662,14 8,12.4329966 8,10.5 C8,8.56700338 6.43299662,7 4.5,7 C2.56700338,7 1,8.56700338 1,10.5 C1,12.4329966 2.56700338,14 4.5,14 Z M2.5,10 L4,10 L4,8.5 L5,8.5 L5,10 L6.5,10 L6.5,11 L5,11 L5,12.5 L4,12.5 L4,11 L2.5,11 L2.5,10 Z"></path><circle cx="2" cy="5" r="1"></circle><circle cx="1.94117647" cy="1" r="1"></circle><rect x="5" y="4" width="12" height="2"></rect><rect x="9" y="8" width="8" height="2"></rect><rect x="9" y="12" width="8" height="2"></rect></g></g></g></svg><div class="js-playlist-addto-label">Add&nbsp;To</div></button></div></div></div></div></div></div></li><li class="js-font-control-panel font-control-activator"><a href="https://www.safaribooksonline.com/library/view/mastering-akka/9781786465023/ch03s03.html#" data-push-state="false" id="font-controls" title="Change font size" aria-label="Change font size"><span class="icon">Toggle Font Controls</span></a></li><li class="dropdown sharing-controls"><a href="https://www.safaribooksonline.com/library/view/mastering-akka/9781786465023/ch03s03.html#" class="trigger" data-push-state="false" title="Share" aria-label="Share"><i class="fa fa-share"></i></a><ul class="social-sharing dropdown-menu"><li><a class="twitter share-button t-twitter" target="_blank" aria-label="Share this section on Twitter" title="Share this section on Twitter" href="https://twitter.com/share?url=https://www.safaribooksonline.com/library/view/mastering-akka/9781786465023/ch03s03.html&amp;text=Mastering%20Akka&amp;via=safari"><span>Twitter</span></a></li><li><a class="facebook share-button t-facebook" target="_blank" aria-label="Share this section on Facebook" title="Share this section on Facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://www.safaribooksonline.com/library/view/mastering-akka/9781786465023/ch03s03.html"><span>Facebook</span></a></li><li><a class="googleplus share-button t-googleplus" target="_blank" aria-label="Share this secton on Google Plus" title="Share this secton on Google Plus" href="https://plus.google.com/share?url=https://www.safaribooksonline.com/library/view/mastering-akka/9781786465023/ch03s03.html"><span>Google Plus</span></a></li><li><a class="email share-button t-email" aria-label="Share this section via email" title="Share this section via email" href="mailto:?subject=Safari:%20Designing%20our%20DDD%20refactor&amp;body=https://www.safaribooksonline.com/library/view/mastering-akka/9781786465023/ch03s03.html%0D%0Afrom%20Mastering%20Akka%0D%0A"><span>Email</span></a></li></ul></li>      </ul>    </div>    <section role="document">                 <!--[if lt IE 9]>  <![endif]-->          	  <div class="t-sbo-prev sbo-prev sbo-nav-top">                    <a href="https://www.safaribooksonline.com/library/view/mastering-akka/9781786465023/ch03s02.html" class="prev nav-link">                <span aria-hidden="true" class="pagination-label t-prev-label">Prev</span>          <span class="visuallyhidden">Previous Chapter</span>          <div class="pagination-title t-prev-title">Identifying anemic vs rich models</div>        </a>        </div>  <div class="t-sbo-next sbo-next sbo-nav-top">                    <a href="https://www.safaribooksonline.com/library/view/mastering-akka/9781786465023/ch03s04.html" class="next nav-link">                <span aria-hidden="true" class="pagination-label t-next-label">Next</span>          <span class="visuallyhidden">Next Chapter</span>          <div class="pagination-title t-next-title">Understanding the refactored bookstore code</div>        </a>        </div><div id="sbo-rt-content" style="transform: none;"><div class="annotator-wrapper"><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="ch03lvl1sec21"></a>Designing our DDD refactor</h1></div></div></div><p>Before we get started with laying out the DDD refactor, it bears mentioning that as the code stands right now, DDD is probably a bit much for it. A DDD approach is good for complex domains and large systems, neither of which can really be said about the current bookstore app. You sort of have to use your imagination here and visualize this app being developed by multiple teams within a large organization, with each module being owned by different teams. With that kind of backdrop in place, a refactor like this makes more sense and is a better fit for the DDD problem set.</p><p>The two major goals for our refactor are as follows:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Enrich the model and have it be more representative of the problem domain, using DDD building blocks such as entities and aggregates.</li><li class="listitem">Split the application into four separate bounded contexts for customer management, inventory management, credit processing, and sales order processing.</li></ol></div><p>Before we jump into the code, it makes sense to do a little modeling first. The major artifacts we want to produce to lead us into the code implementation are a context map and also some basic class diagrams for each bounded context.</p><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec39"></a>The bookstore context map</h2></div></div></div><p>Back when describing strategic DDD, we talked about the importance of producing a context map. This diagram will show the different bounded contexts within the domain as well as the different integration patterns for those contexts. The context map for the changes we'll make to the bookstore app can be seen in the following diagram:</p><p></p><div class="mediaobject"><img src="https://www.safaribooksonline.com/library/view/mastering-akka/9781786465023/graphics/B05567_03_04.jpg" alt="The bookstore context map" width="470" height="336" data-mfp-src="/library/view/mastering-akka/9781786465023/graphics/B05567_03_04.jpg"></div><p></p><p>In this diagram, each separate context is represented by a bubble. The lines between the contexts represent the relationships/integrations between them. The <span class="strong"><strong>U</strong></span> and <span class="strong"><strong>D</strong></span> letters represent the upstream and downstream sides of the relationship, respectively, with an upstream context having influence over one that is downstream from it.</p><p>In the diagram, you can see that <span class="strong"><strong>Sales Order Processing</strong></span> is highly dependent on the other contexts in the system. The relationship types I have set up between <span class="strong"><strong>Sales Order Processing</strong></span> and the other contexts are sort of arbitrary, but they are what I, reasonably, think would exist in our fictitious organization. A lot of deciding on what strategy to use depends on the teams you have and how they work together. Since I don't really have that, I had to make guesses on how these contexts should depend on each other.</p><p>The relationship between <span class="strong"><strong>Sales Order Processing</strong></span> and <span class="strong"><strong>Credit Processing</strong></span> was set up as a <span class="strong"><strong>Customer/Supplier</strong></span> relationship. The reason I chose this versus a <span class="strong"><strong>Conformist</strong></span> is that I believe these two are pretty closely tied together. In fact, <span class="strong"><strong>Credit Processing</strong></span> may exist mostly to serve the needs of the <span class="strong"><strong>Sales Order Processing</strong></span> context. Because&nbsp;<span class="strong"><strong>Sales Order Processing</strong></span> is a primary stakeholder in <span class="strong"><strong>Credit Processing</strong></span>&nbsp;I chose <span class="strong"><strong>Customer/Supplier</strong></span>, as it implies a higher level of cooperation between the teams creating these contexts.</p><p>In contrast, the relationship between <span class="strong"><strong>Sales Order Processing</strong></span> and both&nbsp;<span class="strong"><strong>Inventory Management</strong></span> and <span class="strong"><strong>User Management</strong></span>&nbsp;was set up as <span class="strong"><strong>Conformist</strong></span>. My thought here was that these contexts have their own needs above and beyond just being there to support sales. They should not let the needs of sales creep into their models, as sales is probably only a small part of what they do. As such, I saw <span class="strong"><strong>Sales Order Processing</strong></span> needing to conform to whatever these two contexts do without any direct influence into their development plans.</p><p>One thing to note in this diagram is that the bookstore-common library is not represented in this context map. Some may have thought of this library as a shared kernel that all other contexts have a relationship with. To me, the things done in that common library are more infrastructure related than domain related. Infrastructure is a separate layer to the domain layer, so that's why you don't see that library in this context map.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec40"></a>Modelling DDD with actors</h2></div></div></div><p>The idea with this remodeling will be to place the emphasis on the domain entities within each individual context, making them own the majority of the logic related to managing themselves. We will also try and introduce a ubiquitous language around user management, modeling after real-life concepts, and then having the code closely resemble the language and those concepts.</p><p>In the old model, the domain entities were just simple-case classes. They didn't have any logic, validations, or operations associated with them other than the simple setting and getting of fields. In the new model, the entities will be modeled as actors who receive messages that represent the operations (or vocabulary) that can be performed against that entity. In this way, the entities themselves will be richer in the functionality that they expose and the logic they handle.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl3sec56"></a>Understanding the vocabulary of a component</h3></div></div></div><p>When referring to the vocabulary of an entity or aggregate, I'm referring to the commands (requests) as well as the events that it can handle as a result of those commands. This is the language that a certain entity or aggregate can speak, and it's how other components within the system communicate with it. For the code in this book, I am putting the vocabulary on the companions of the actors that the language is for. I think it's a decent enough approach for an actor-oriented DDD system, as it keeps the terminology with the component that speaks it.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl3sec57"></a>Difficulties of DDD and actors</h3></div></div></div><p>One of the difficulties in doing DDD with actors is that actors don't directly expose their external state. For an actor-based entity, that is, if you request a reference to that entity, all you get is <code class="literal">ActorRef</code> and getting at the fields won't be so easy. You'd have to send another message after (an ask) to get the field info, and this just seemed a bit clunky to me. For this reason, I created a concept called <code class="literal">FieldsObject</code> within the model that is a lightweight representation of entities fields or attributes. I intentionally avoided calling it <code class="literal">ValueObject</code> because the term value object already has meaning within DDD and I didn't want to create any confusion.</p><p>In doing this refactoring, I toyed with the idea of returning richer proxies to the actors that had all the full-field values and the operations for that entity directly exposed in order to make calls to an underlying <code class="literal">ActorRef</code> (via ask), and then return a Future for the new entity in a kind of async copy semantic similar to the copy on a case class. This will be more in line with a properly modeled DDD, but I felt it was pushing away from actors more and that was not a direction I wanted to go in. Bottom line, modeling DDD with actors can be a challenge but that doesn't mean it shouldn't be attempted. This is a stepping stone in our total refactoring effort and it will lend itself well to transitioning to event sourcing in <a class="link" href="https://www.safaribooksonline.com/library/view/mastering-akka/9781786465023/ch04.html">Chapter 4</a>, <span class="emphasis"><em>Making History with Event Sourcing</em></span>.</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec41"></a>Remodeling the user management context</h2></div></div></div><p>The first context we will ply our new DDD trade on is the user management context. The new model to show the major players within that context can be seen in the following diagram:</p><p></p><div class="mediaobject"><img src="https://www.safaribooksonline.com/library/view/mastering-akka/9781786465023/graphics/B05567_03_05.jpg" alt="Remodeling the user management context" width="840" height="486" data-mfp-src="/library/view/mastering-akka/9781786465023/graphics/B05567_03_05.jpg"></div><p></p><p>In the new model, you can see that <code class="literal">BookstoreUser</code> has changed from a basic case class to an actor. The text appearing in the methods section of the class box represents the messages that the actor handles.</p><p>Sitting in front of that entity actor (and acting as its supervisor) is <code class="literal">CustomerRelationsManager</code>. I'm calling this an aggregate because it is responsible for the <code class="literal">BookstoreUser</code> entities underneath it, and it's where the calls for those entities initially flow through. The items in its methods section represent the actions (or vocabulary) it can handle against the <code class="literal">BookstoreUser</code> entities.</p><p>We also have a DDD repository class, <code class="literal">BookstoreUserRepository</code>, where the SQL related logic happens. This is a slight change (currently in name only) from the old model where we used DAO classes to handle SQL logic. A repository is meant to be a higher level abstraction than a DAO though, as it deals with objects and collections of objects whereas a DAO deals with lower level data. A repository can use a DAO, to provide a swappable (via dependency injection) abstraction as to how it gets its objects, but for simplicity's sake, we did not do that here. This particular repository class handles all of the lookup and management operations for the <code class="literal">BookstoreUser</code> entity that go against the relational database.</p><p>Lastly, we have <code class="literal">fieldsobject</code> for the <code class="literal">BookstoreUser</code> entity called <code class="literal">BookstoreUserFO</code>. This is what will be returned to anyone who requests an instance of a particular <code class="literal">BookstoreUser</code> entity.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec42"></a>Remodeling the inventory management context</h2></div></div></div><p>The next bounded context that need to be remodeled is the inventory management context (formerly the book-services module). A diagram showing the new model can be seen below:</p><p></p><div class="mediaobject"><img src="https://www.safaribooksonline.com/library/view/mastering-akka/9781786465023/graphics/B05567_03_06.jpg" alt="Remodeling the inventory management context" width="730" height="538" data-mfp-src="/library/view/mastering-akka/9781786465023/graphics/B05567_03_06.jpg"></div><p></p><p>The concepts here are the same as the new user management model, with the aggregate, repository, entity, and fields object used to remodel inventory management.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec43"></a>Remodeling the credit processing context</h2></div></div></div><p>The next context to look at is the credit processing context. The same approach will be followed here as we did with the other remodeling efforts, having the entity, repository, and fields object. The diagram for this model is as follows:</p><p></p><div class="mediaobject"><img src="https://www.safaribooksonline.com/library/view/mastering-akka/9781786465023/graphics/B05567_03_07.jpg" alt="Remodeling the credit processing context" width="820" height="482" data-mfp-src="/library/view/mastering-akka/9781786465023/graphics/B05567_03_07.jpg"></div><p></p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec44"></a>Remodeling the sales order processing context</h2></div></div></div><p>The last context to remodel is the sales order processing context. The updated diagram for this context is as follows:</p><p></p><div class="mediaobject"><img src="https://www.safaribooksonline.com/library/view/mastering-akka/9781786465023/graphics/B05567_03_08.jpg" alt="Remodeling the sales order processing context" width="710" height="528" data-mfp-src="/library/view/mastering-akka/9781786465023/graphics/B05567_03_08.jpg"></div><p></p><p>Things get a little more interesting with this model, as we have a DDD aggregate root in the <code class="literal">SalesOrder</code> entity. This entity also manages and exposes (via a fields object) the line items that make up the order.</p></div></div><div class="annotator-outer annotator-viewer viewer annotator-hide">  <ul class="annotator-widget annotator-listing"></ul></div><div class="annotator-modal-wrapper annotator-editor-modal annotator-editor annotator-hide">	<div class="annotator-outer editor">		<h2 class="title">Highlight</h2>		<form class="annotator-widget">			<ul class="annotator-listing">			<li class="annotator-item"><textarea id="annotator-field-0" placeholder="Add a note using markdown (optional)" class="js-editor" maxlength="750"></textarea></li></ul>			<div class="annotator-controls">				<a class="link-to-markdown" href="https://daringfireball.net/projects/markdown/basics" target="_blank">?</a>				<ul>					<li class="delete annotator-hide"><a href="https://www.safaribooksonline.com/library/view/mastering-akka/9781786465023/ch03s03.html#delete" class="annotator-delete-note button positive">Delete Note</a></li>					<li class="save"><a href="https://www.safaribooksonline.com/library/view/mastering-akka/9781786465023/ch03s03.html#save" class="annotator-save annotator-focus button positive">Save Note</a></li>					<li class="cancel"><a href="https://www.safaribooksonline.com/library/view/mastering-akka/9781786465023/ch03s03.html#cancel" class="annotator-cancel button">Cancel</a></li>				</ul>			</div>		</form>	</div></div><div class="annotator-modal-wrapper annotator-delete-confirm-modal" style="display: none;">  <div class="annotator-outer">    <h2 class="title">Highlight</h2>      <a class="js-close-delete-confirm annotator-cancel close" href="https://www.safaribooksonline.com/library/view/mastering-akka/9781786465023/ch03s03.html#close">Close</a>      <div class="annotator-widget">         <div class="delete-confirm">            Are you sure you want to permanently delete this note?         </div>         <div class="annotator-controls">            <a href="https://www.safaribooksonline.com/library/view/mastering-akka/9781786465023/ch03s03.html#cancel" class="annotator-cancel button js-cancel-delete-confirm">No, I changed my mind</a>            <a href="https://www.safaribooksonline.com/library/view/mastering-akka/9781786465023/ch03s03.html#delete" class="annotator-delete button positive js-delete-confirm">Yes, delete it</a>         </div>       </div>   </div></div><div class="annotator-adder" style="display: none;">	<ul class="adders ">				<li class="copy"><a href="https://www.safaribooksonline.com/library/view/mastering-akka/9781786465023/ch03s03.html#">Copy</a></li>				<li class="add-highlight"><a href="https://www.safaribooksonline.com/library/view/mastering-akka/9781786465023/ch03s03.html#">Add Highlight</a></li>		<li class="add-note"><a href="https://www.safaribooksonline.com/library/view/mastering-akka/9781786465023/ch03s03.html#">							Add Note					</a></li>			</ul></div></div></div>  <div class="t-sbo-prev sbo-prev sbo-nav-bottom">                    <a href="https://www.safaribooksonline.com/library/view/mastering-akka/9781786465023/ch03s02.html" class="prev nav-link">                <span aria-hidden="true" class="pagination-label t-prev-label">Prev</span>          <span class="visuallyhidden">Previous Chapter</span>          <div class="pagination-title t-prev-title">Identifying anemic vs rich models</div>        </a>        </div>  <div class="t-sbo-next sbo-next sbo-nav-bottom">                    <a href="https://www.safaribooksonline.com/library/view/mastering-akka/9781786465023/ch03s04.html" class="next nav-link">                <span aria-hidden="true" class="pagination-label t-next-label">Next</span>          <span class="visuallyhidden">Next Chapter</span>          <div class="pagination-title t-next-title">Understanding the refactored bookstore code</div>        </a>        </div>            </section>  </div><section class="sbo-saved-archives"></section>                                    <div id="js-subscribe-nag" class="subscribe-nag clearfix trial-panel t-subscribe-nag collapsed slideUp">                                                          <p>You have 1 day left in your trial, Ottoventeduo. Subscribe today. <a href="https://www.safaribooksonline.com/subscribe/" class="ga-active-trial-subscribe-nag">See pricing options.</a></p>                                </div>                      </div>        <footer class="pagefoot t-pagefoot" style="padding-bottom: 68px;">    <a href="https://www.safaribooksonline.com/library/view/mastering-akka/9781786465023/ch03s03.html#" class="icon-up"><div class="visuallyhidden">Back to top</div></a>    <ul class="js-footer-nav">              <li><a class="t-recommendations-footer" href="https://www.safaribooksonline.com/r/">Recommended</a></li>            <li>      <a class="t-queue-footer" href="https://www.safaribooksonline.com/playlists/">Playlists</a>      </li>              <li><a class="t-recent-footer" href="https://www.safaribooksonline.com/history/">History</a></li>        <li><a class="t-topics-footer" href="https://www.safaribooksonline.com/topics?q=*&amp;limit=21">Topics</a></li>                    <li><a class="t-tutorials-footer" href="https://www.safaribooksonline.com/tutorials/">Tutorials</a></li>            <li><a class="t-settings-footer js-settings" href="https://www.safaribooksonline.com/u/preferences/">Settings</a></li>      <li class="full-support"><a href="https://www.safaribooksonline.com/public/support">Support</a></li>      <li><a href="https://www.safaribooksonline.com/apps/">Get the App</a></li>      <li><a href="https://www.safaribooksonline.com/accounts/logout/">Sign Out</a></li>    </ul>    <span class="copyright">© 2018 <a href="https://www.safaribooksonline.com/" target="_blank">Safari</a>.</span>    <a href="https://www.safaribooksonline.com/terms/">Terms of Service</a> /    <a href="https://www.safaribooksonline.com/privacy/">Privacy Policy</a>  </footer>              <img src="https://www.oreilly.com/library/view/oreilly_set_cookie/" alt="" style="display:none;">              <div class="annotator-notice"></div><div class="font-flyout"><div class="font-controls-panel">	<div class="nightmodes">		<ul>			<li class="day"><a href="https://www.safaribooksonline.com/library/view/mastering-akka/9781786465023/ch03s03.html#" id="day-mode" title="Day Mode">				<i class="fa fa-sun-o"></i>				<span>Day Mode</span></a></li>			<li class="cloudy"><a href="https://www.safaribooksonline.com/library/view/mastering-akka/9781786465023/ch03s03.html#" id="cloudy-mode" title="Cloudy Mode">				<i class="fa fa-cloud"></i>				<span>Cloud Mode</span>			</a></li>			<li class="night"><a href="https://www.safaribooksonline.com/library/view/mastering-akka/9781786465023/ch03s03.html#" id="night-mode" title="Night Mode">				<i class="fa fa-moon-o"></i>				<span>Night Mode</span>			</a></li>		</ul>	</div>	<div class="font-resizer resizer">		<div class="draggable-containment-wrapper">			<i class="fa fa-font left"></i>			<span class="filler" style="width: 50%;"></span>			<div id="js-font-size-draggable" class="draggable ui-widget-content ui-draggable ui-draggable-handle" style="position: relative; left: 80px;"></div>			<i class="fa fa-font right"></i>		</div>	</div>	<div class="column-resizer resizer">		<div class="draggable-containment-wrapper">			<i class="fa fa-compress left"></i>			<span class="filler" style="width: 50%;"></span>			<div id="js-column-size-draggable" class="draggable ui-widget-content ui-draggable ui-draggable-handle" style="position: relative; left: 80px;"></div>			<i class="fa fa-expand right"></i>		</div>	</div>	<a id="reset" class="button" href="https://www.safaribooksonline.com/library/view/mastering-akka/9781786465023/ch03s03.html#">Reset</a></div></div>
</body>
</html>